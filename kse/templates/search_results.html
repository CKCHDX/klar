{% extends "base.html" %}

{% block title %}"{{ query }}" - Sökresultat - Klar{% endblock %}

{% block content %}
<div class="search-header">
    <div class="container">
        <form method="GET" action="{{ url_for('search_page') }}" class="search-form-small">
            <input type="text" 
                   name="q" 
                   class="search-input-small" 
                   value="{{ query }}"
                   placeholder="Sök på svenska...">
            <button type="submit" class="search-button-small">
                <i class="fas fa-search"></i>
            </button>
        </form>
    </div>
</div>

<div class="container">
    <div class="search-results-page">
        <!-- Search Info -->
        <div class="search-info">
            <p>Ungefär <strong>{{ total_results|format_number }}</strong> resultat 
               ({{ "%.2f"|format(search_time / 1000) }} sekunder)</p>
        </div>
        
        <!-- Results List -->
        <div class="results-list">
            {% if results %}
                {% for result in results %}
                    <div class="result-item">
                        <h3>
                            <a href="{{ result.url }}" target="_blank" rel="noopener">{{ result.title }}</a>
                        </h3>
                        <p class="result-url">{{ result.url }}</p>
                        <p class="result-snippet">{{ result.snippet[:200] }}...</p>
                        <div class="result-meta">
                            <span class="result-score">
                                <i class="fas fa-star"></i> Score: {{ result.score }}
                            </span>
                            {% if result.last_updated %}
                                <span class="result-updated">
                                    <i class="fas fa-clock"></i> {{ result.last_updated }}
                                </span>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="no-results">
                    <h2>Är det ingen resultat?</h2>
                    <p>Prova att</p>
                    <ul>
                        <li>Kontrollera stavningen</li>
                        <li>Använd enklare ord</li>
                        <li>Prova andra sökord</li>
                    </ul>
                </div>
            {% endif %}
        </div>
        
        <!-- Pagination -->
        {% if total_pages > 1 %}
            <div class="pagination">
                {% if page > 1 %}
                    <a href="{{ url_for('search_page', q=query, page=1) }}" class="page-link first-page">
                        <i class="fas fa-chevron-left"></i> Första
                    </a>
                    <a href="{{ url_for('search_page', q=query, page=page-1) }}" class="page-link prev-page">
                        <i class="fas fa-chevron-left"></i> Föregående
                    </a>
                {% endif %}
                
                {% for p in range(max(1, page-2), min(total_pages+1, page+3)) %}
                    {% if p == page %}
                        <span class="page-number active">{{ p }}</span>
                    {% else %}
                        <a href="{{ url_for('search_page', q=query, page=p) }}" class="page-number">{{ p }}</a>
                    {% endif %}
                {% endfor %}
                
                {% if page < total_pages %}
                    <a href="{{ url_for('search_page', q=query, page=page+1) }}" class="page-link next-page">
                        Nästa <i class="fas fa-chevron-right"></i>
                    </a>
                    <a href="{{ url_for('search_page', q=query, page=total_pages) }}" class="page-link last-page">
                        Sista <i class="fas fa-chevron-right"></i>
                    </a>
                {% endif %}
            </div>
        {% endif %}
    </div>
    
    <!-- Sidebar -->
    <aside class="results-sidebar">
        <div class="sidebar-section">
            <h4>Filter</h4>
            <div class="filter-group">
                <label class="filter-label">
                    <input type="checkbox" name="filter" value="recent" checked>
                    Senaste först
                </label>
                <label class="filter-label">
                    <input type="checkbox" name="filter" value="relevant" checked>
                    Mest relevant
                </label>
            </div>
        </div>
        
        <div class="sidebar-section">
            <h4>Domäner</h4>
            <div class="domain-list">
                <!-- Popular domains in results -->
                <a href="#" class="domain-link">gov.se</a>
                <a href="#" class="domain-link">stockholm.se</a>
                <a href="#" class="domain-link">wikipedia.se</a>
            </div>
        </div>
    </aside>
</div>

<script>
    // Results page interactions
    document.querySelectorAll('.result-item').forEach(item => {
        item.addEventListener('mouseover', () => {
            item.classList.add('hover');
        });
        item.addEventListener('mouseout', () => {
            item.classList.remove('hover');
        });
    });
</script>
{% endblock %}
